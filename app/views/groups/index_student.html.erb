<% if current_user.group_member_of.nil? %>

  <div class="row-fluid">
    <div class="span12 well">
      You are currently not a member of any group.
    </div>
  </div>

  <div class="row-fluid">
    <div class="span12 well">
      <h4>Create a New Group</h4>

      <div class="row-fluid">
        <%= form_tag controller: "groups", action: "new_student_group" do %>
          <%= text_field_tag 'group_name', nil, class: "span4" %>
          <%= hidden_field_tag :student_gtusername, current_user.gtusername, class: "span4" %>
          <%= submit_tag "Create", class: "span2" %>
        <% end %>
      </div>

    </div>
  </div>

  <div class="row-fluid">
    <div class="span12 well">
      <h4>Request to join an Existing Group</h4>

      <div class="row-fluid">
        <%= form_tag controller: "groups", action: "request_to_join" do %>
          <%= text_field_tag 'group_name', nil, class: "span4", :placeholder => "name of group" %>
          <%= hidden_field_tag :student_gtusername, current_user.gtusername, class: "span4" %>
          <%= submit_tag "Request", class: "span2" %>
        <% end %>
      </div>

      <% if current_user.requests_to_join_groups %>
        <h5>Existing Requests</h5>
        <div class="row-fluid">
          <div class="span12">
            <% current_user.requests_to_join_groups.each do |group| %>
              <%= group.name %>
              <br />
            <% end %>
          </div>
        </div>
      <% end %>

    </div>
  </div>

<% else %>

  <div class="row-fluid well">
    <div class="span8">
      You are currently a member of <strong><%= current_user.group_member_of.name %></strong>
    </div>
    <div class="span4">
      <%= form_tag controller: "groups", action: "leave_group" do %>
        <%= hidden_field_tag :student_gtusername, current_user.gtusername, class: "span4" %>
        <%= submit_tag "Leave Group", :confirm => "Are you sure you want to leave the group? If you are the only memeber, this action will also delete the group." %>
      <% end %>
    </div>
  </div>

  <div class="row-fluid well">
    <div class="span12">
      <h4>Pending Requests to join your group</h4>

      <% if current_user.my_groups_requests %>
        <% current_user.my_groups_requests.each do |student| %>
          <div class="row-fluid">
            <div class="span4">
              <%= student.gtusername %>
            </div>
            <div class="span4">
              <%= link_to "Accept", accept_request_groups_path(group_name: current_user.group_member_of.name, student_gtusername: student.gtusername), :method => :post %> 
            </div>
            <div class="span4">
            </div>
          </div>
        <% end %>
      <% else %>
        None
      <% end %>

    </div>
  </div>

<% end %>
