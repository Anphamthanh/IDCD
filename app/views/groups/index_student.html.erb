<h1>Groups</h1>
<br>
<% if !current_user.is_owner? %>

  <div class="row-fluid">
    <div class="span12 well">
      You are currently not a member of any group.
    </div>
  </div>

  <div class="row-fluid">
    <div class="span12 well">
      <h4>Create a New Group</h4>

      <div class="row-fluid">
        <%= form_tag controller: "groups", action: "add_new_group" do %>
          <%= text_field_tag 'group_name', nil, class: "span4", :placeholder => "name of group" %>
          <%= submit_tag "Create", class: "span2" %>
        <% end %>
      </div>

    </div>
  </div>

  <% if current_user.my_invites.count > 0 %>
    <div class="row-fluid">
      <div class="span12 well highlight-red">
        <h4>Invitations to join other Groups</h4>

        <div class="row-fluid">
          <div class="span12">
            <% current_user.my_invites.each do |group| %>
              <div class="span4">
                <%= group.name %>
              </div>
              <%= link_to "Accept", accept_invite_groups_path(group_id: group.id), :class => "span2" %>
              <%= link_to "Reject", reject_invite_groups_path(group_id: group.id), :class => "span2" %>
              <br />
            <% end %>
          </div>
        </div>

      </div>
    </div>
  <% end %>

  <div class="row-fluid">
    <div class="span12 well">
      <h4>Request to join an Existing Group</h4>

      <div class="row-fluid">
        <%= form_tag controller: "groups", action: "send_request" do %>
          <%= text_field_tag 'group_name', nil, class: "span4", :placeholder => "name of group" %>
          <%= submit_tag "Request", class: "span2" %>
        <% end %>
      </div>

      <h4>Pending Requests</h4>

      <% if current_user.my_requests.count > 0 %>
        <div class="row-fluid">
          <div class="span12">
            <% current_user.my_requests.each do |group| %>
              <%= group.name %>
              <br />
            <% end %>
          </div>
        </div>
      <% else %>
        None
      <% end %>

    </div>
  </div>





<% else %>





  <div class="row-fluid well">
    <div class="span12">

      <div class="row-fluid">
        <div class="span8">
          You are currently a member of <strong><%= current_user.my_group.name %></strong>
        </div>
        <%= link_to "Leave Group", leave_group_groups_path, :class => "span3" %>
      </div>

      <div class="row-fluid">
        <div class="span5">
        <h4>All members</h4>

        <table>
          <tr>
            <th>Name</th>
            <th>Section</th>
          </tr>

          <% current_user.my_group.owners.each do |student| %>
            <tr>
              <td><%= "#{student.gtusername}" %></td>
              <td><%= "#{student.section.name}" %></td>
            </tr>
          <% end %>
        </table>
      </div>
      </div>

    </div>
  </div>


  <div class="row-fluid well">
    <div class="span12">
      <h4>Invite Students to your Group</h4>

      <div class="row-fluid">
        <%= form_tag controller: "groups", action: "send_invite" do %>
          <%= text_field_tag 'student_gtusername', nil, class: "span4", :placeholder => "gtusername of student" %>
          <%= submit_tag "Invite", class: "span2" %>
        <% end %>
      </div>

    </div>
  </div>

  <% if current_user.my_groups_requests.count > 0 %>
    <div class="row-fluid well highlight-red">
      <div class="span12">
        <h4>Requests to join your Group</h4>

        <div class="row-fluid">
          <div class="span12">
            <% current_user.my_groups_requests.each do |student| %>
              <div class="span4">
                <%= student.gtusername %>
              </div>
              <%= link_to "Accept", accept_request_groups_path(student_id: student.id), :class => "span2" %>
              <%= link_to "Reject", reject_request_groups_path(student_id: student.id), :class => "span2" %>
              <br />
            <% end %>
          </div>
        </div>
      </div>
    </div>
  <% end %>

  <div class="row-fluid well">
    <div class="span12">
      <h4>Pending Invites</h4>

      <% if current_user.my_groups_invites.count > 0 %>
        <div class="row-fluid">
          <div class="span12">
            <% current_user.my_groups_invites.each do |student| %>
              <%= student.gtusername %>
              <br />
            <% end %>
          </div>
        </div>
      <% else %>
        None
      <% end %>

    </div>
  </div>


<% end %>
